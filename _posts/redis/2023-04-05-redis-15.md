---
title: "[Redis] HyperLogLog(HLL)"
excerpt: "ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì„ ìœ„í•œ í™•ë¥ ì  ìë£Œêµ¬ì¡°"

categories:
  -  Redis
tags:
  - [BackEnd, DB, Redis]

toc: true
toc_sticky: true
 
date: 2023-04-05
last_modified_at: 2023-04-05
---

# ğŸš€ HyperLogLog(HLL)
---
Redisì˜ HyperLogLog(HLL)ì€ ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì˜ ê³ ìœ í•œ ìš”ì†Œì˜ ê°œìˆ˜ë¥¼ ì¶”ì •í•˜ê¸° ìœ„í•œ í™•ë¥ ì  ìë£Œêµ¬ì¡°ì´ë‹¤. 
HLLì€ Redis ë²„ì „ 2.8 ì´ìƒì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## ğŸ“ HLL ë™ì‘ ë°©ì‹
HLLì€ ëŒ€ëŸ‰ì˜ ì¤‘ë³µ ìš”ì†Œë¥¼ ê°€ì§„ ë°ì´í„°ì…‹ì—ì„œ ê³ ìœ í•œ ìš”ì†Œì˜ ê°œìˆ˜ë¥¼ ì¶”ì •í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.
ì´ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ HLLì€ ì¹´ìš´íŠ¸í•  ê°’ë“¤ì˜ í•´ì‹œ ê°’ì„ ì‚¬ìš©í•˜ì—¬ ì§‘í•©ì˜ ê·¼ì‚¬ ì¹´ë””ë„ë¦¬í‹°(cardinality)ë¥¼ ê³„ì‚°í•œë‹¤.

HLLì˜ ë™ì‘ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. HLLì„ ì´ˆê¸°í™”í•œë‹¤.
2. ë°ì´í„°ì…‹ì˜ ê° ìš”ì†Œì— ëŒ€í•´ í•´ì‹œ ê°’ì„ ê³„ì‚°í•œë‹¤.
3. ê° í•´ì‹œ ê°’ì˜ ì´ì§„ìˆ˜ í‘œí˜„ì—ì„œ, ê°€ì¥ ì˜¤ë¥¸ìª½ì— ìˆëŠ” 1ì˜ ìœ„ì¹˜ë¥¼ ì°¾ëŠ”ë‹¤.
4. ì´ì§„ìˆ˜ì—ì„œ 1ì˜ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•´ë‹¹ ìœ„ì¹˜ì˜ ì¸ë±ìŠ¤ë¥¼ HLLì˜ ë ˆì§€ìŠ¤í„° ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤.
5. HLLì˜ ë ˆì§€ìŠ¤í„° ê°’ ì¤‘ ê°€ì¥ í° ê°’ì„ ì‚¬ìš©í•˜ì—¬ ì§‘í•©ì˜ ê·¼ì‚¬ ì¹´ë””ë„ë¦¬í‹°ë¥¼ ê³„ì‚°í•œë‹¤.
6. HLLì€ ë°ì´í„°ì…‹ì˜ í¬ê¸°ì— ìƒê´€ì—†ì´ ì¼ì •í•œ ì˜¤ì°¨ ë²”ìœ„ ë‚´ì—ì„œ ê·¼ì‚¬ ì¹´ë””ë„ë¦¬í‹° ê°’ì„ ì œê³µí•œë‹¤.

## ğŸ“ Command
- **PFADD key element [element ...]**  
  HLLì— ìƒˆ ìš”ì†Œë¥¼ ì¶”ê°€í•œë‹¤.  
  ë§Œì•½ HLLì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ìƒˆë¡œìš´ HLLì„ ìƒì„±í•œë‹¤.

- **PFCOUNT key [key ...]**  
  HLLì— í¬í•¨ëœ ê³ ìœ  ìš”ì†Œì˜ ê°œìˆ˜(ì¹´ë””ë„ë¦¬í‹°)ë¥¼ ë°˜í™˜í•œë‹¤.

- **PFMERGE destkey sourcekey [sourcekey ...]**  
  ì—¬ëŸ¬ HLLì„ í•˜ë‚˜ë¡œ ë³‘í•©í•œë‹¤.  
  ```
  127.0.0.1:6379> PFADD visitors john mary sam
  (integer) 1
  127.0.0.1:6379> PFCOUNT visitors
  (integer) 3
  127.0.0.1:6379> PFADD visitors mary tom jerry
  (integer) 1
  127.0.0.1:6379> PFCOUNT visitors
  (integer) 4
  127.0.0.1:6379> PFADD newvisitors john adam sam
  (integer) 1
  127.0.0.1:6379> PFMERGE totalvisitors visitors newvisitors
  OK
  127.0.0.1:6379> PFCOUNT totalvisitors
  (integer) 5
  ```
  ìœ„ ì˜ˆì œì—ì„œ, 
  1. "visitors"ë¼ëŠ” HLLì— "john", "mary", "sam"ì´ ì¶”ê°€ë˜ì–´ PFCOUNT ëª…ë ¹ì–´ë¡œ 3ì„ ë°˜í™˜í•œë‹¤. 
  2. ê·¸ ë‹¤ìŒ "mary", "tom", "jerry"ê°€ ì¶”ê°€ë˜ì–´ PFCOUNT ëª…ë ¹ì–´ë¡œ 4ë¥¼ ë°˜í™˜í•œë‹¤. 
  3. "newvisitors"ë¼ëŠ” ìƒˆë¡œìš´ HLLì— "john", "adam", "sam"ì´ ì¶”ê°€ëœë‹¤. 
  4. ê·¸ ë‹¤ìŒ, PFMERGE ëª…ë ¹ì–´ë¡œ "visitors", "newvisitors"ë¥¼ í•˜ë‚˜ë¡œ ë³‘í•©í•˜ì—¬ "totalvisitors"ë¼ëŠ” HLLì„ ìƒì„±í•œë‹¤. 
  5. PFCOUNT ëª…ë ¹ì–´ë¡œ "totalvisitors"ì˜ ì¹´ë””ë„ë¦¬í‹°ë¥¼ ê³„ì‚°í•˜ë©´ 5ë¥¼ ë°˜í™˜í•œë‹¤.

> [Redis Bootcamp for Beginners: Get Hands On with Redis.](https://www.udemy.com/course/redis-bootcamp-for-beginners/)  
> [í™•ë¥ ì  ìë£Œêµ¬ì¡°ë¥¼ ì´ìš©í•œ ì¶”ì • - ìœ ì¼í•œ ì›ì†Œ ê°œìˆ˜(Cardinality) ì¶”ì •ê³¼ HyperLogLog](https://d2.naver.com/helloworld/711301)