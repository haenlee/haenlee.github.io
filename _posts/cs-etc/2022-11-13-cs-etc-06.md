---
title: "[DevOps] Docker"
excerpt: "" 

categories:
  - CS/ETC
tags:
  - [DevOps, Docker]

toc: true
toc_sticky: true
 
date: 2022-11-13
last_modified_at: 2022-11-13
---

# 🚀 Docker
---
## 📝 Docker란?
![image](https://user-images.githubusercontent.com/85219306/201503171-c69c127f-06fd-4bb1-a67f-fe0c3c024cf2.png)

- Docker는 오픈 소스 컨테이너화 플랫폼으로 애플리케이션을 컨테이너로 패키징할 수 있는 툴
- 다양한 프로그램 및 실행환경을 컨테이너로 추상화하고 동일한 Interface를 제공하여 프로그램의 배포 및 관리를 단순하게 해준다.

## 📝 Docker 사용 이유
만약 프로젝트를 제작하면서 개인 로컬 환경에서 모든 플랫폼을 직접 설치해 코드 작성 및 테스트를 진행하고 문제가 없어 외부 서버에 배포를 한다고 가정했을 때, `배포 환경과 개발 환경의 차이로 인해 발생할 수 있는 문제점`은 개발 환경에서 제어할 수 없고 예측하기 힘들다. 

이러한 문제를 해결하기 위해서는 어플리케이션 구성을 위한 여러 플랫폼의 종류나 버전이 항상 동일하게 유지되고 수정될 수 있도록 독립적인 개발 및 배포 환경이 필요하다.

즉, 서버를 구축할 때 서버마다 운영체제, 컴파일러, 패키지 등의 차이가 발생하게 되는데 Docker는 작업자가 원하는 시점의 서버 상태를 정해둘 수 있게 하여 항상 똑같은 상태의 서버를 만들 수 있게 해준다.

<br>
# 🚀 이미지
---
- 도커 이미지는 컨테이너를 만드는 데 사용되는 읽기 전용(Read-only) 템플릿이다.
- 컨테이너 실행에 필요한 파일과 설정값 등을 포함하고 있는 Docker 파일을 만든 후 Dockerfile을 빌드 하여 이미지를 만든다.

<br>
# 🚀 컨테이너
---
**컨테이너란 애플리케이션 소스 코드를 임의의 환경에서 해당 코드의 실행에 필요한 운영체제 라이브러리 및 종속 항목과 결합하는 실행 가능한 표준 컴포넌트를 말한다.**
{: .notice--info}

- 호스터 컴퓨터에서 돌아가고 있는 하나의 프로세스
- 호스트 컴퓨터와 그 위에서 돌아가는 다른 프로세스들과 격리되도록 설계되어있다. (효율성과 보안성)
- 격리된 환경에서 개발 환경의 통일성을 갖추기 위해 사용한다.
- 다양한 서버에서 버전 통일성을 갖추기 위해 코드와 환경 모두 하나의 컨테이너로 묶는 역할을 한다.
  - 하나의 Docker 이미지로 여러 개의 Docker 컨테이너를 만들 수 있다.  
  - Docker 이미지를 변경해도 이미 실행 중인 Docker 컨테이너에는 영향을 주지 않는다.

➡ `**Docker 이미지를 실행한 상태**`  
이미지로 컨테이너를 생성하면 이미지의 목적에 맞는 파일이 들어있는 파일 시스템과 격리된 시스템 자원 및 네트워크를 사용할 수 있는 독립된 공간이 생성되는데, 이것을 Docker 컨테이너라고 한다.  
Docker 컨테이너는 읽기 전용인 이미지에 변경된 사항을 저장하는 컨테이너 계층(Layer)에 저장한다.

![image](https://user-images.githubusercontent.com/85219306/201504189-8e1cd0ff-f354-469e-930d-5ffe104d69fe.png)

<br>
# 🚀 Dockerfile
---
- Dockerfile은 DockerImage를 생성하기 위한 스크립트(설정파일)이다.
- 여러가지 명령어를 토대로 Dockerfile을 작성한 후 빌드하면 Docker는 Dockerfile에 나열된 명령문을 차례대로 수행하며 DockerImage를 생성해준다.
- Dockerfile을 읽을 줄 안다는 것은 해당 이미지가 어떻게 구성되어 있는지 알 수 있다는 의미이다.
- ex)
```
FROM ubuntu:18.04
COPY . /app
RUN make /app
CMD python /app/app.py
```

## 📝 Dockerfile 장점
### 🔸 이미지가 어떻게 만들어졌는지를 기록한다.
보통 사람들은 완성된 이미지를 가져다 쓰기 때문에 이미지가 어떻게 만들어졌는지에 대해서는 알 필요가 없다.
그러나 개발자의 경우라면 조금 다르다. 어떠한 애플리케이션을 담고 있는 이미지가 설치 되기 위한 과정은 어떠한지, 중간에 어떠한 과정을 수정해야 하는지 등을 알아야 하는 경우가 있다.

예를 들어 raw한 상태의 우분투 이미지에서 자신이 원하는 애플리케이션을 담은 이미지를 만들어내기까지, 그 과정들을 기록하고 수정하며 바꿔나갈 수 있다는 것이다.
이는 Dockerfile이 자동화된 스크립트 형태이기 때문이다.

### 🔸 배포에 용이하다.
어떠한 이미지를 배포할 때, 몇 기가씩이나 되는 이미지 파일 자체를 배포하기보다는 그 이미지를 만들 수 있는 스크립트인 Dockerfile만을 배포한다면 매우 편리할 것이다.
사용자는 그 스크립트를 실행시키기만 하면 스스로가 그 Dockerfile에 해당하는 이미지를 얻을 수 있기 때문이다.
실제로 Docker Hub에 가면, Dockerfile로 이미지를 배포하고 있는 사람들을 볼 수 있다.

### 🔸 컨테이너(이미지)가 특정 행동을 수행하도록 한다.
컨테이너 환경에서 애플리케이션을 개발하다 보면, 특정 행동을 취하도록 하는 컨테이너를(이미지를) 만들어야 할 때가 있다.

<br>
# 🚀 Docker vs. VM
---
## 📝 Docker
- 하드웨어에 설치된 운영체제에 Container Engine이라는 소프트웨어를 설치해 개별적인 Container를 만들어 각각의 어플리케이션을 고립된 환경에서 구동할 수 있게 해준다. 
- 여기서 가장 많이 사용되는 Container Engine이 바로 Docker이다. VM의 경량화 버전이라고 생각할 수 있다.

## 📝 VM 
- 하드웨어 위에 올라가는 vmware나 VirtualBox 같은 Hypervisor을 이용해 독립적인 가상의 머신을 만들 수 있다. 
- 동일한 어플리케이션을 다양한 OS위에서 구동하기 위한 소프트웨어로, 각각의 VM에는 OS가 올라가기 때문에 굉장히 무겁고 느리다.