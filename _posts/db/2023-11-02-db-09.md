---
title: "[DB] 실무에서 Foreign key를 사용하지 않는 이유"
excerpt: "" 

categories:
  - DB
tags:
  - [DB, Foreign key, 참조무결성]

toc: true
toc_sticky: true
 
date: 2023-11-02
last_modified_at: 2023-11-02
---

# 🚀 Foreign key
---
참조 무결성은 관계형 데이터베이스 내에서 `데이터 관계의 정확성과 일관성을 보장`하는 데이터베이스 관리의 개념이다.
이는 데이터베이스의 테이블 간 관계를 정의하고 유지하는 일련의 규칙과 제약 조건이다.
참조 무결성의 주요 목적은 데이터 이상을 방지하고 데이터 베이스의 무결성을 유지하는 것이다.

## 📝 Primary key
- 테이블 row에 대한 고유한 식별자
- 테이블의 각 record를 고유하게 식별할 수 있도록 보장

## 📝 Foreign key
- 테이블의 필드로 다른 테이블의 Primary key
- 두 테이블 데이터간의 연결을 설정

참조 무결성을 강화하면 데이터의 정확성과 일관성을 유지할 수 있으며, 테이블 간의 불완전하거나 부정확한 관계에서 발생할 수 있는 record, 데이터 불일치와 같은 문제를 방지할 수 있다.

<br>
# 🚀 실무에서 Foreign key를 사용하지 않는 이유
---
참조 무결성이 관계형 데이터베이스에서 중요한 개념이라는 것은 누구나 알고 있다.
하지만 실무에서는 참조 무결성을 보장할 수 있는 Foreign key 사용을 추천하지 않는다.
Foreign key를 사용하지 않는 여러가지 이유가 있지만, 그중 중요한 내용에 대해서 알아보려고 한다.

- 성능 문제  
  Foreign key는 특히 대규모 데이터셋을 다룰 때 데이터베이스에 영향을 준다.  
  일부 트래픽이 많거나 트랜잭션 비율이 높은 응용 프로그램에서는 Foreign key를 인덱싱하고 검사할 때 오버헤드가 발생할 수 있다.

- Legacy 데이터베이스  
  경우에 따라 원래 Foreign key로 설계되지 않은 Legacy 데이터베이스를 다루게 될 수도 있다.  
  이때, 기존 데이터 불일치로 인해 문제가 발생할 수 있다.

- 불완전한 데이터  
  의도적으로 불완전한 데이터를 다루고 있거나 일부 관계가 선택적인 경우, Foreign key를 사용하는 것은 데이터베이스내 관계를 강제하기 때문에 적절하지 않을 수 있다.

즉, Foreign key를 사용하지 않는 이유는 `성능 문제뿐만 아니라 개발시 Foreign key로 인한 많은 제약조건`이 생긴다는 것이다.
그럼 Foreign key를 사용하지 않는 데이터베이스를 어떻게 만들 수 있을지에 대해 의문이 생기게 된다.

- 애플리케이션 레벨에서 코드로 데이터 일관성 관리  
  비즈니스 논리를 코드로 구현하고 관계를 엄격히 관리하고 갱신한다.

- 트리거 사용  
  DB 트리거를 사용하여 데이터 변경 이벤트를 감지하고 데이터 일관성을 유지한다.  

- 데이터베이스 트랜잭션 및 롤백  
  트랜잭션을 사용하여 데이터 일관성을 확보하고 문제가 발생할 경우 롤백한다.

- 데이터베이스 정규화  
  정규화 과정을 통해 데이터 일관성을 향상시킬 수 있다.  
  데이터를 정규화된 상태로 유지하면 테이블간의 관계를 유지하기 쉽다.

또한, 보통 Primary key와 Foreign key는 자동으로 Index 테이블이 생성되기 때문에 별도의 Index를 걸어주는 과정이 필요하지 않다.
하지만 개념상 Foreign key로 사용하려는 속성을 Foreign key로 설정하지 않고 사용할 때는 Index를 걸어 검색 속도를 높일 수 있다.

결론적으로 Foreing key를 사용하는 것은 참조 무결성 측면에서는 필수적이다.
하지만 개발시 무결성, 정합성보다 개발 편의성과 확장성을 우선시하겠다면 Foreign key를 사용하지 않을 수 있을것이다.

> [외래키를 사용해? 말어?](https://lackofwillpower.tistory.com/76)