---
title:  "[토비의 스프링] 08. 스프링이란 무엇인가?"
excerpt: ""

categories:
  - Toby-Spring
tags:
  - [Spring]

toc: true
toc_sticky: true
 
date: 2022-09-20
last_modified_at: 2022-09-20
---

## 08. 스프링이란 무엇인가?

## 8.1 스프링의 정의
- 스프링에 대해 가장 널리 알려진 정의는 아래와 같다.<br>
자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크

### 애플리케이션 프레임워크
- 일반적으로 라이브러리와 프레임워크는 특정 업무 분야나 한 가지 기술에 특화된 목표를 가지고 만들어지지만 스프링은 이와 다르게 ‘애플리케이션 프레임워크’ 라는 특징을 가지고 있다.<br>
- 로드 존슨이 2003년에 출판한 『Expert One-on-One J2EE Design and Development』 라는 책에서부터 시작되었다.
    - 책에서 강조한 중요한 전략의 하나는 “항상 프레임워크 기반으로 접근하라"는 것이었다.
    - 책 안에 들어있는 샘플 애플리케이션 프레임워크을 시작으로 현재의 스프링이 탄생했다.

✔️ 애플리케이션 프레임워크(Application Framework)
- 특정 계층이나, 기술, 업무 분야에 국한되지 않고 애플리케이션의 전 영역을 포괄하는 범용적인 프레임워크
- 애플리케이션 개발의 전 과정을 빠르고 편리하며 효율적으로 진행하는 데 목표를 둔다.

### 경량급(Lightweight)
- 스프링의 정의중 경량급은 스프링 자체가 가볍다거나 작은 규모의 코드로 이루어졌다는 뜻이 아니다.
- 스프링이 가볍다고 하는 이유는 불필요하게 무겁지 않다는 뜻이다.(과거 복잡하고 무거운 EJB 대비)
- 타 프레임워크 대비 코드가 지원하는 기술 수준은 비슷하더라도 빠르고 간편하게 작성하게 해줌으로써 생산성과 품질면에서 유리하다는 것이 경량급이라는 말로 표현된다.

### 자바 엔터프라이즈 개발을 편하게
- 복잡한 기술이었던 EJB도 처음 등장했을 때 해당 문구를 사용했다.
- 편리한 애플리케이션 개발이란 개발자가 복잡하고 실수하기 쉬운 로우레벨 기술 보단 비즈니스 로직을 빠르고 효과적으로 구현하는 것을 말한다.
- 스프링은 애플리케이션 개발자들이 스프링이라는 프레임워크가 제공하는 기술이 아니라 자신이 작성하는 애플리케이션의 로직이 더 많은 관심과 시간을 쏟게 해준다.
- 스프링은 엔터프라이즈 개발에서 기술적인 요구를 충족하면서도 개발을 복잡하게 만들지 않는다

### 오픈소스
- 스프링은 오픈소스 프로젝트 방식으로 개발되어왔다. 적용된 오픈소스 라이선스는 아파지 라이선스 2.0이다.

✔️ 아파치 라이선스 2.0(Apache License 2.0)
- 누구나 해당 소프트웨어에서 파생된 프로그램을 제작할 수 있으며 저작권을 양도, 전송할 수 있는 라이선스 규정을 의미한다.

## 8.2 스프링의 목적
- 스프링을 사용해서 엔터프라이즈 개발을 편하게 하려는 이유는 엔터프라이즈 개발이 편하지 않기 때문이다.

### 엔터프라이즈 개발의 복잡함
- 자바 엔터프라이즈 시스템 개발이 어려운 가장 큰 이유는 근본적인 비즈니스 로직과 엔터프라이즈 기술이라는 두 가지 복잡함이 얽혀있기 때문이다.
- 복잡함을 해결하려면 성격이 다른 두 가지 복잡함을 분리하는 것이다.

### 비침투적인 방식을 통한 효과적인 해결책: 스프링
- 기술의 적용 사실이 코드에 직접 반영되지 않는다는 특징이 있는 기술을 비침투적인(non-invasive)기술이라고 한다.
- 스프링을 사용하면 기술적인 복잡함과 비즈니스 로직을 다루는 코드를 분리할 수 있다.

### 기술적인 복잡함을 상대하는 전략
- 스프링의 기본적인 전략은 비즈니스 로직과 엔터프라이즈 기술을 처리하는 코드를 분리하는 것이다.
- 스프링은 다음과 같은 문제에 적절한 대응 방법을 제공한다.

✔️ 기술에 대한 접근 방식이 일관성이 없고 특정 환경에 종속적이다.
- 일관성이 없는 기술은 서비스 추상화로 해결한다.
- 기술적인 복잡합은 일단 추상화를 통해 기술 구현 부분과 기술을 사용하는 인터페이스를 분리하고, 환경과 세부기술에 독립적인 접근 인터페이스를 제공하는 것이 가장 좋은 해결책이다.

✔️ 기술적인 처리를 담당하는 코드가 성격이 다른 코드에 섞여서 등장한다.
- 대표적인 예시로 비즈니스 로직 전후로 경계가 설정돼야 하는 트랜잭션과 로깅과 같은 코드가 있다.
- 위 기술과 비즈니스 로직의 혼재로 발생하는 복잡함을 스프링은 AOP를 이용해서 해결한다.
- AOP는 최후까지 애플리케이션 로직을 담당하는 코드에 남아 있는 기술 관련 코드를 깔끔하게 분리해서 별도의 모듈로 관리하게 해줄 수 있다.

### 비즈니스와 애플리케이션 로직의 복잡함을 상대하는 전략
- 비즈니스 로직의 복잡함을 상대하는 전략은 자바라는 객체지향 기술 그 자체다. 스프링은 단지 객체지향 언어의 장점을 제대로 살리지 못하게 방해했던 요소를 제거하도록 도와줄 뿐이다.

### 핵심 도구: 객체지향과 DI
- 객체지향의 설계 기법을 잘 적용할 수 있는 구조를 만들기 위해 DI 같은 유용한 기술을 편하게 적용하도록 도와주는 것이 스프링의 기본 전략이다.
- 기술적인 복잡함을 해결하는 문제나 기술적인 복잡함이 비즈니스 로직에 침범하지 못하도록 분리하는 경우에도 DI가 바탕이 된 여러 가지 기법이 활용된다.<br>
반면에 비즈니스 로직 자체의 복잡함을 해결하려면 DI보다 객체지향 설계 기법이 더 중요하다.
- 객체지향적인 특성을 잘 살린 설계는 상속과 다형성, 위임을 포함해서 많은 객체지향 디자인 패턴과 설계 기법이 잘 녹아있다.
- 모든 스프링의 기술과 전략은 객체지향이라는 자바 언어가 가진 강력한 도구를 극대화해서 사용할 수 있도록돕는 것이다.

## 8.3 POJO 프로그래밍
- 스프링의 핵심 개발자들이 쓴 『Professional Spring Framework』 라는 책에서는 스프링의 정수(essence)는 “엔터프라이즈 서비스 기능을 POJO에 제공하는 것” 이라고 했다.
- 엔터프라이즈 서비스라고 하는 것은 보안, 트랜잭션과 같은 기술들을 말한다.

### 스프링의 핵심: POJO
- 스프링 애플리케이션은 POJO를 이용해서 만든 애플리케이션 코드와, POJO가 어떻게 관계를 맺고 동작하는지 정의해놓은 설계정보로 구분된다.
- 스프링의 주요 기술인 IoC/DI, AOP, PSA는 애플리케이션을 POJO로 개발 할 수 있게 해주는 가능기술이라고 불린다.

### POJO란 무엇인가?
- Plain Old Java Object의 첫 글자를 따서 만든 약어다.
- 다음의 조건을 충족해야 POJO라고 할 수 있다.
    - 특정 규약에 종속되지 않는다.
        - 자바 언어와 꼭 필요한 API외에는 종속되지 않아야 한다.
        - 객체지향 설계의 자유로운 적용이 가능한 오브젝트여야만 한다.
    - 특정 환경에 종속되지 않는다.
        - 비즈니스 로직에 웹 프레임워크와 같은 클래스를 이용하는 부분이 있다면 진정한 POJO라고 볼 수 없다.
- 진정한 POJO란 객제치향적인 원리에 충실하면서, 환경과 기술에 종속되지 않고 필요에 따라 재활용될 수 있는 방식으로 설계된 오브젝트를 말한다.

### POJO의 장점
- POJO가 될 수 있는 조건이 그대로 장점이된다. 기술과 환경에 종속되지 않는 오브젝트는 깔끔한 코드가 될 수 있다.
- 자동화된 테스트에 유리하다.
- 객체지향적인 설계를 자유롭게 적용할 수 있다.

### POJO 프레임워크
- POJO 프로그래밍이 가능하도록 기술적인 기반을 제공하는 프레임워크를 POJO 프레임워크라 한다.
- 대표적으로 스프링 프레임워크와 하이버네이트가 있다.

## 8.4 스프링의 기술
### 제어의 역전(IoC) / 의존관계 주입(DI)
- 왜 두 개의 오브젝트를 분리해서 만들고, 인터페이스를 두고 느슨하게 연결한 뒤, 실제 사용할 대상은 DI를 통해서 외부에서 지정하는 것일까?
    - 유연한 확장이 가능하게 하기 위해서 외부에서 지정한다.
- DI는 개방 폐쇄 원칙(OCP)이라는 객체지향 설계 원칙으로 설명될 수 있다.
    - 유연한 확장은 OCP의 확장에는 열려 있다(개방)에 해당한다.
    - DI는 OCP의 변경에는 닫혀 있다(폐쇄)라는 말로도 설명이 가능하다.

### DI의 활용 방법
- 핵심 기능의 변경
    - 실제 의존하는 대상이 가진 핵심기능을 DI 설정을 통해 변경하는 것이 대표적인 DI 활용 방법이다.
- 핵심기능의 동적인 변경
    - DI를 잘 활용하면 애플리케이션이 동작하는 중간에 의존 대상을 다이내믹하게 변경할 수 있다.
- 부가기능의 추가
    - 데코레이터 패턴과 인터페이스를 두고 사용하게 하고, 실제 사용할 오브젝트는 외부에서 주입하는 DI를 적용해두면 핵심기능과 클라이언트 코드에는 전혀 영향을 주지 않으면서 부가기능을 추가할 수 있다.
    - 부가기능의 추가 방식을 특정 오브젝트가 아니라 좀 더 많은 대상으로 일반화해서 적용하면 AOP가 된다.
- 인터페이스의 변경
    - 사용하려고 하는 오브젝트가 가진 인터페이스가 클라이언트와 호환되지 않는 경우가 있다.<br>
    이렇게 클라이언트가 사용하는 인터페이스와 실제 오브젝트 사이에 인터페이스가 일치하지 않는 경우에도 DI가 유용하다.
    - 디자인 패턴에서 말하는 오브젝트 방식의 어댑터 패턴의 응용이라고 볼 수 있다.
- 프록시
    - 다음과 같은 두 가지 방법을 사용할 때 DI를 필요로 한다.
    - 필요한 시점에서 실제 사용할 오브젝트를 초기화하고 리소스를 준비하게 해주는 지연된 로딩을 적용하려면 프록시가 필요하다.
    - 원격 오브젝트를 호출할 때 마치 로컬에 존재하는 오브젝트처럼 사용할 수 있게 해주는 원격 프록시를 적용하려고 할 때도 프록시가 필요하다.
- 템플릿과 콜백
    - 템플릿/콜백 패턴은 DI의 특별한 적용방법이다.
    - 고정적인 작업 흐름과 그 사이 변경되는 부분을 분리해서 템플릿과 콜백으로 만들고 이를 DI 원리를 응용해 적용하면 지저분하게 매번 만들어야 하는 코드를 간결하게 만들 수 있다.
- 싱글톤과 오브젝트 스코프
    - DI가 필요한 중요한 이유 중 한 가지는 DI를 할 오브젝트의 생명주기를 제어할 수 있다는 것이다.
    - DI를 프레임워크로 이용한다는 건 DI 대상 오브젝트를 컨테이너가 관리한다는 의미다.<br>
    오브젝트의 생성부터 관계 설정, 이용, 소멸에 이르기까지의 모든 과정을 DI 컨테이너가 주관하기 때문에 그 오브젝트의 스코프를 자유롭게 제어할 수 있다.
    - 스프링의 DI는 기본적으로 싱글톤으로 오브젝트를 만들어서 사용하게 한다.<br>
    컨테이너가 알아서 싱글톤으로 만들고 관리하기 때문에 클래스 자체는 싱글톤을 고려하지 않고 자유롭게 설계해도 된다는 장점이 있다.
- 테스트
    - 다른 오브젝트와 협력해서 동작하는 오브젝트를 효과적으로 테스트하는 방법은 가능한 한 고립시키는 것이다.
    - 테스트할 대상이 의존하는 오브젝트를, 테스트를 목적으로 만들어진 오브젝트로 대체하면 유용하다.
    - 의존 오브젝트를 대신해서 스텁 또는 목 오브젝트 같은 테스트 대역을 활용할 때도 DI를 사용한다.

### 애스펙트 지향 프로그래밍(AOP)
- 스프링의 3대 기술중 하나이다.
- AOP는 OOP처럼 독립적인 프로그래밍 패러다임이 아니다.
- AOP는 객체지향의 한계와 단점을 극복하도록 도와주는 보조적인 프로그래밍 기술이다.

### AOP 적용기법
- 스프링과 같이 다이내믹 프록시를 사용하는 방법
    - 기존 코드에 영향을 주지않고 부가기능을 적용하게 해주는 데코레이터 패턴을 으용한 것이다.
    - 부가기능을 부여할 수 있는 곳은 메소드의 호출이 일어나는 지점뿐이라는 제약이 있다.
    - 스프링의 기본적인 AOP 구현 방법은 다이내믹 프록시를 이용하는 방법이다.
- AspectJ 사용
    - AspectJ를 사용한 방법으로 프록시 방식의 AOP에서는 불가능한 다양한 조인 포인트를 제공한다.
    - 메소드 호출뿐 아니라 인스턴스의 생성, 필드 엑세스, 특정 호출 경로를 가진 메소드 호출 등에도 부가기능을 제공할 수 있다.

### 포터블 서비스 추상화(PSA, Portable Service Abstraction)
- 환경과 세부 기술의 변화에 관계없이 일관된 방식으로 기술에 접근 할 수 있게 해주는 기술이다.
- POJO로 개발된 코드는 특정 환경이나 구현 방식에 종속적이지 않아야 한다.
- 스프링은 POJO 코드가 특정 기술에 종속되지 않게 일관성 있는 서비스 추상화 기술을 제공한다.